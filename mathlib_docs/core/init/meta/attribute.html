<!DOCTYPE html><html lang="en"><head><title>core.init.meta.attribute</title><meta charset="UTF-8"><link rel="stylesheet" href="https://robertylewis.com/mathlib_docs/style.css"></head><body><div class="mod_doc"><p></p>
</div><div class="cnst"><a id="attribute.get_instances"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L12">attribute.get_instances</a></span> <span class="decl_args">(a : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> (<a href="https://robertylewis.com/mathlib_docs/core/init/core.html#list">list</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</div>
<div class="indent"><p>Get all of the declaration names that have the given attribute.
Eg. <code>get_instances `simp</code> returns a list with the names of all of the lemmas in the environment tagged with the <code>@[simp]</code> attribute.</p>
       </div>
</div><div class="cnst"><a id="attribute.fingerprint"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L14">attribute.fingerprint</a></span> <span class="decl_args">(a : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> ℕ</div>
<div class="indent"><p>Returns a hash of <code>get_instances</code>. You can use this to tell if your attribute instances have changed.</p>
       </div>
</div><div class="cnst"><a id="user_attribute_cache_cfg"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L21">user_attribute_cache_cfg</a></span> <span class="decl_args">(cache_ty : Type)</span> <span class="decl_args">:</span>       <div class="decl_type">Type</div>
<div class="indent"><p>Configuration for a user attribute cache. For example, the <code>simp</code> attribute has a cache of type simp_lemmas.
   - <code>mk_cache</code> is a function where you are given all of the declarations tagged with your attribute and you return the new value for the cache.
       That is, <code>mk_cache</code> makes the object you want to be cached.
   - <code>dependencies</code> [TODO] is a list of other attributes whose caches need to be computed first.</p>
       </div>
</div><div class="def"><a id="user_attribute.dflt_cache_cfg"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L26">user_attribute.dflt_cache_cfg</a></span>  <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p>Close the current goal by filling it with the trivial <code>user_attribute_cache_cfg unit</code>.</p>
       </div>
</div><div class="def"><a id="user_attribute.dflt_parser"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L28">user_attribute.dflt_parser</a></span>  <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="cnst"><a id="user_attribute"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L54">user_attribute</a></span> <span class="decl_args">(cache_ty param_ty : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#opt_param">opt_param</a> Type <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a>)</span> <span class="decl_args">:</span>       <div class="decl_type">Type</div>
<div class="indent"><p>A <strong>user attribute</strong> is an attribute defined by the user (ie, not built in to Lean).</p>

<h3>Type parameters</h3>

<ul>
<li><code>cache_ty</code> is the type of a cached VM object that is computed from all of the declarations in the environment tagged with this attribute.</li>
<li><code>param_ty</code> is an argument for the attribute when it is used. For instance with <code>param_ty</code> being <code>ℕ</code> you could write <code>@[my_attribute 4]</code>.</li>
</ul>

<h3>Data</h3>

<p>A <code>user_attribute</code> consists of the following pieces of data:
- <code>name</code> is the name of the attribute, eg <code>simp</code>
- <code>descr</code> is a plaintext description of the attribute for humans.
- <code>after_set</code> is an optional handler that will be called after the attribute has been applied to a declaration.
    Failing the tactic will fail the entire <code>attribute/def/...</code> command, i.e. the attribute will
    not be applied after all.
    Declaring an <code>after_set</code> handler without a <code>before_unset</code> handler will make the attribute
    non-removable.
- <code>before_unset</code> Optional handler that will be called before the attribute is removed from a declaration.
- <code>cache_cfg</code> describes how to construct the user attribute's cache. See docstring for <code>user_attribute_cache_cfg</code>
- <code>reflect_param</code> demands that <code>param_ty</code> can be reflected.
    This means we have a function from <code>param_ty</code> to an expr.
    See the docstring for <code>has_reflect</code>.
- <code>parser</code> Parser that will be invoked after parsing the attribute's name. The parse result will be reflected
and stored and can be retrieved with <code>user_attribute.get_param</code>.</p>
       </div>
</div><div class="def"><a id="attribute.register"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L65">attribute.register</a></span> <span class="decl_args">(decl : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p>Registers a new user-defined attribute. The argument must be the name of a definition of type
  <code>user_attribute α β</code>. Once registered, you may tag declarations with this attribute.</p>
       </div>
</div><div class="cnst"><a id="user_attribute.get_cache"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L69">user_attribute.get_cache</a></span> <span class="decl_args">{α β : Type}</span> <span class="decl_args">(attr : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> α</div>
<div class="indent"><p>Returns the attribute cache for the given user attribute.</p>
       </div>
</div><div class="def"><a id="user_attribute.parse_reflect"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L71">user_attribute.parse_reflect</a></span> <span class="decl_args">{α β : Type}</span> <span class="decl_args">(attr : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/lean/parser.html#lean.parser">lean.parser</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#expr">expr</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="cnst"><a id="user_attribute.get_param_untyped"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L74">user_attribute.get_param_untyped</a></span> <span class="decl_args">{α β : Type}</span> <span class="decl_args">(attr : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β)</span> <span class="decl_args">(decl : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#expr">expr</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="cnst"><a id="user_attribute.set_untyped"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L76">user_attribute.set_untyped</a></span> <span class="decl_args">{α β : Type}</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> β]</span> <span class="decl_args">(attr : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β)</span> <span class="decl_args">(decl : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">(val : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#expr">expr</a>)</span> <span class="decl_args">(persistent : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#bool">bool</a>)</span> <span class="decl_args">(prio : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#opt_param">opt_param</a> (<a href="https://robertylewis.com/mathlib_docs/core/init/core.html#option">option</a> ℕ) option.none)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="user_attribute.get_param"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L80">user_attribute.get_param</a></span> <span class="decl_args">{α β : Type}</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> β]</span> <span class="decl_args">(attr : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β)</span> <span class="decl_args">(n : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> β</div>
<div class="indent"><p>Get the value of the parameter for the attribute on a given declatation. Will fail if the attribute does not exist.</p>
       </div>
</div><div class="def"><a id="user_attribute.set"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L83">user_attribute.set</a></span> <span class="decl_args">{α β : Type}</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> β]</span> <span class="decl_args">(attr : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β)</span> <span class="decl_args">(n : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">(val : β)</span> <span class="decl_args">(persistent : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#bool">bool</a>)</span> <span class="decl_args">(prio : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#opt_param">opt_param</a> (<a href="https://robertylewis.com/mathlib_docs/core/init/core.html#option">option</a> ℕ) option.none)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="register_attribute"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L90">register_attribute</a></span> <span class="decl_args">(decl : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p>Alias for attribute.register</p>
       </div>
</div><div class="def"><a id="get_attribute_cache_dyn"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L92">get_attribute_cache_dyn</a></span> <span class="decl_args">{α : Type}</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> α]</span> <span class="decl_args">(attr_decl_name : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> α</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="mk_name_set_attr"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L98">mk_name_set_attr</a></span> <span class="decl_args">(attr_name : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="get_name_set_for_attr"></a>      <span class="decl_name"><a href="https://github.com/leanprover-community/lean/blob/80c1b4d67eec24f1d1e5b4b3ed7082c27851271d/library/init/meta/attribute.lean#L108">get_name_set_for_attr</a></span> <span class="decl_args">(<a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a> : _root_.name)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/rb_map.html#name_set">name_set</a></div>
<div class="indent"><p></p>
       </div>
</div></body></html>