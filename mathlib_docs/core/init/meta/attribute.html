<!DOCTYPE html><html lang="en"><head><title>core.init.meta.attribute</title><meta charset="UTF-8"><link rel="stylesheet" href="/home/rob/lean/mathlib/scripts/html_out/style.css"></head><body><div class="mod_doc"><p></p>
</div><div class="cnst"><a id="attribute.get_instances"></a>      <h4>attribute.get_instances</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> (<a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#list">list</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a>)</code>
<div class="indent"><p>Get all of the declaration names that have the given attribute.
Eg. <code>get_instances `simp</code> returns a list with the names of all of the lemmas in the environment tagged with the <code>@[simp]</code> attribute.</p>
       </div>
</div><div class="cnst"><a id="attribute.fingerprint"></a>      <h4>attribute.fingerprint</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> ℕ</code>
<div class="indent"><p>Returns a hash of <code>get_instances</code>. You can use this to tell if your attribute instances have changed.</p>
       </div>
</div><div class="cnst"><a id="user_attribute_cache_cfg"></a>      <h4>user_attribute_cache_cfg</h4><code>Type → Type</code>
<div class="indent"><p>Configuration for a user attribute cache. For example, the <code>simp</code> attribute has a cache of type simp_lemmas.
   - <code>mk_cache</code> is a function where you are given all of the declarations tagged with your attribute and you return the new value for the cache.
       That is, <code>mk_cache</code> makes the object you want to be cached.
   - <code>dependencies</code> [TODO] is a list of other attributes whose caches need to be computed first.</p>
       </div>
</div><div class="def"><a id="user_attribute.dflt_cache_cfg"></a>      <h4>user_attribute.dflt_cache_cfg</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a></code>
<div class="indent"><p>Close the current goal by filling it with the trivial <code>user_attribute_cache_cfg unit</code>.</p>
       </div>
</div><div class="def"><a id="user_attribute.dflt_parser"></a>      <h4>user_attribute.dflt_parser</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a></code>
<div class="indent"><p></p>
       </div>
</div><div class="cnst"><a id="user_attribute"></a>      <h4>user_attribute</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#opt_param">opt_param</a> Type <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#opt_param">opt_param</a> Type <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a> → Type</code>
<div class="indent"><p>A <strong>user attribute</strong> is an attribute defined by the user (ie, not built in to Lean).</p>

<h3>Type parameters</h3>

<ul>
<li><code>cache_ty</code> is the type of a cached VM object that is computed from all of the declarations in the environment tagged with this attribute.</li>
<li><code>param_ty</code> is an argument for the attribute when it is used. For instance with <code>param_ty</code> being <code>ℕ</code> you could write <code>@[my_attribute 4]</code>.</li>
</ul>

<h3>Data</h3>

<p>A <code>user_attribute</code> consists of the following pieces of data:
- <code>name</code> is the name of the attribute, eg <code>simp</code>
- <code>descr</code> is a plaintext description of the attribute for humans.
- <code>after_set</code> is an optional handler that will be called after the attribute has been applied to a declaration.
    Failing the tactic will fail the entire <code>attribute/def/...</code> command, i.e. the attribute will
    not be applied after all.
    Declaring an <code>after_set</code> handler without a <code>before_unset</code> handler will make the attribute
    non-removable.
- <code>before_unset</code> Optional handler that will be called before the attribute is removed from a declaration.
- <code>cache_cfg</code> describes how to construct the user attribute's cache. See docstring for <code>user_attribute_cache_cfg</code>
- <code>reflect_param</code> demands that <code>param_ty</code> can be reflected.
    This means we have a function from <code>param_ty</code> to an expr.
    See the docstring for <code>has_reflect</code>.
- <code>parser</code> Parser that will be invoked after parsing the attribute's name. The parse result will be reflected
and stored and can be retrieved with <code>user_attribute.get_param</code>.</p>
       </div>
</div><div class="def"><a id="attribute.register"></a>      <h4>attribute.register</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a></code>
<div class="indent"><p>Registers a new user-defined attribute. The argument must be the name of a definition of type
  <code>user_attribute α β</code>. Once registered, you may tag declarations with this attribute.</p>
       </div>
</div><div class="cnst"><a id="user_attribute.get_cache"></a>      <h4>user_attribute.get_cache</h4><code>Π {α β : Type}, <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> α</code>
<div class="indent"><p>Returns the attribute cache for the given user attribute.</p>
       </div>
</div><div class="def"><a id="user_attribute.parse_reflect"></a>      <h4>user_attribute.parse_reflect</h4><code>Π {α β : Type}, <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/lean/parser.html#lean.parser">lean.parser</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/expr.html#expr">expr</a></code>
<div class="indent"><p></p>
       </div>
</div><div class="cnst"><a id="user_attribute.get_param_untyped"></a>      <h4>user_attribute.get_param_untyped</h4><code>Π {α β : Type}, <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/expr.html#expr">expr</a></code>
<div class="indent"><p></p>
       </div>
</div><div class="cnst"><a id="user_attribute.set_untyped"></a>      <h4>user_attribute.set_untyped</h4><code>Π {α β : Type} [_inst_1 : <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/expr.html#reflected">reflected</a> β],
  <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/expr.html#expr">expr</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#bool">bool</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#opt_param">opt_param</a> (<a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#option">option</a> ℕ) option.none → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a></code>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="user_attribute.get_param"></a>      <h4>user_attribute.get_param</h4><code>Π {α β : Type} [_inst_1 : <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/expr.html#reflected">reflected</a> β], <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> β</code>
<div class="indent"><p>Get the value of the parameter for the attribute on a given declatation. Will fail if the attribute does not exist.</p>
       </div>
</div><div class="def"><a id="user_attribute.set"></a>      <h4>user_attribute.set</h4><code>Π {α β : Type} [_inst_1 : <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/expr.html#reflected">reflected</a> β],
  <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/attribute.html#user_attribute">user_attribute</a> α β → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → β → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#bool">bool</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#opt_param">opt_param</a> (<a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#option">option</a> ℕ) option.none → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a></code>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="register_attribute"></a>      <h4>register_attribute</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a></code>
<div class="indent"><p>Alias for attribute.register</p>
       </div>
</div><div class="def"><a id="get_attribute_cache_dyn"></a>      <h4>get_attribute_cache_dyn</h4><code>Π {α : Type} [_inst_1 : <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/expr.html#reflected">reflected</a> α], <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> α</code>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="mk_name_set_attr"></a>      <h4>mk_name_set_attr</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/core.html#unit">unit</a></code>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="get_name_set_for_attr"></a>      <h4>get_name_set_for_attr</h4><code><a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/name.html#name">name</a> → <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/tactic.html#tactic">tactic</a> <a href="/home/rob/lean/mathlib/scripts/html_out/core/init/meta/rb_map.html#name_set">name_set</a></code>
<div class="indent"><p></p>
       </div>
</div></body></html>