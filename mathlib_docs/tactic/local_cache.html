<!DOCTYPE html><html lang="en"><head><title>tactic.local_cache</title><meta charset="UTF-8"><link rel="stylesheet" href="https://robertylewis.com/mathlib_docs/style.css"></head><body><div class="mod_doc"><p></p>
</div><div class="def"><a id="tactic.local_cache.internal.mk_full_namespace"></a>      <span class="decl_name">tactic.local_cache.internal.mk_full_namespace</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.save_data"></a>      <span class="decl_name">tactic.local_cache.internal.save_data</span> <span class="decl_args">{α : Type}</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> α]</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/has_reflect.html#has_reflect">has_reflect</a> α]</span> <span class="decl_args">(dn : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">(a : α)</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> a]</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.load_data"></a>      <span class="decl_name">tactic.local_cache.internal.load_data</span> <span class="decl_args">{α : Type}</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> α]</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/has_reflect.html#has_reflect">has_reflect</a> α]</span> <span class="decl_args">(dn : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> α</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.poke_data"></a>      <span class="decl_name">tactic.local_cache.internal.poke_data</span> <span class="decl_args">(dn : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#bool">bool</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.run_once_under_name"></a>      <span class="decl_name">tactic.local_cache.internal.run_once_under_name</span> <span class="decl_args">{α : Type}</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> α]</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/has_reflect.html#has_reflect">has_reflect</a> α]</span> <span class="decl_args">(t : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> α)</span> <span class="decl_args">(cache_name : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> α</div>
<div class="indent"><p></p>
       </div>
</div><div class="cnst"><a id="tactic.local_cache.internal.cache_scope"></a>      <span class="decl_name">tactic.local_cache.internal.cache_scope</span>  <span class="decl_args">:</span>       <div class="decl_type">Type</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.block_local.get_name"></a>      <span class="decl_name">tactic.local_cache.internal.block_local.get_name</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.block_local.try_get_name"></a>      <span class="decl_name">tactic.local_cache.internal.block_local.try_get_name</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.block_local.present"></a>      <span class="decl_name">tactic.local_cache.internal.block_local.present</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#bool">bool</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.block_local.clear"></a>      <span class="decl_name">tactic.local_cache.internal.block_local.clear</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.FNV_OFFSET_BASIS"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.FNV_OFFSET_BASIS</span>  <span class="decl_args">:</span>       <div class="decl_type">ℕ</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.FNV_PRIME"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.FNV_PRIME</span>  <span class="decl_args">:</span>       <div class="decl_type">ℕ</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.RADIX"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.RADIX</span>  <span class="decl_args">:</span>       <div class="decl_type">ℕ</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.hash_byte"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.hash_byte</span> <span class="decl_args">(seed : ℕ)</span> <span class="decl_args">(c : <a href="https://robertylewis.com/mathlib_docs/core/init/data/char/basic.html#char">char</a>)</span> <span class="decl_args">:</span>       <div class="decl_type">ℕ</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.hash_string"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.hash_string</span> <span class="decl_args">(s : <a href="https://robertylewis.com/mathlib_docs/core/init/data/string/basic.html#string">string</a>)</span> <span class="decl_args">:</span>       <div class="decl_type">ℕ</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.hash_context"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.hash_context</span>  <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/data/string/basic.html#string">string</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.get_root_name"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.get_root_name</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.apply_tag"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.apply_tag</span> <span class="decl_args">(n : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">(tag : ℕ)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.mk_dead_name"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.mk_dead_name</span> <span class="decl_args">(n : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.kill_name"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.kill_name</span> <span class="decl_args">(n : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.is_name_dead"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.is_name_dead</span> <span class="decl_args">(n : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#bool">bool</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.get_tag_with_status"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.get_tag_with_status</span> <span class="decl_args">(rn : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> (ℕ × <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#bool">bool</a>)</div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.get_name"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.get_name</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.try_get_name"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.try_get_name</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.present"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.present</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#bool">bool</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.internal.def_local.clear"></a>      <span class="decl_name">tactic.local_cache.internal.def_local.clear</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p></p>
       </div>
</div><div class="def"><a id="tactic.local_cache.cache_scope.block_local"></a>      <span class="decl_name">tactic.local_cache.cache_scope.block_local</span>  <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.internal.cache_scope">tactic.local_cache.internal.cache_scope</a></div>
<div class="indent"><p>This scope propogates the cache within a <code>begin ... end</code> or <code>by</code> block
   and its decendants.</p>
       </div>
</div><div class="def"><a id="tactic.local_cache.cache_scope.def_local"></a>      <span class="decl_name">tactic.local_cache.cache_scope.def_local</span>  <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.internal.cache_scope">tactic.local_cache.internal.cache_scope</a></div>
<div class="indent"><p>This scope propogates the cache within an entire <code>def</code>/<code>lemma</code>.</p>
       </div>
</div><div class="def"><a id="tactic.local_cache.present"></a>      <span class="decl_name">tactic.local_cache.present</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">(s : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#opt_param">opt_param</a> <a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.internal.cache_scope">tactic.local_cache.internal.cache_scope</a> <a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.cache_scope.block_local">tactic.local_cache.cache_scope.block_local</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#bool">bool</a></div>
<div class="indent"><p>Asks whether the namespace <code>ns</code> currently has a value-in-cache.</p>
       </div>
</div><div class="def"><a id="tactic.local_cache.clear"></a>      <span class="decl_name">tactic.local_cache.clear</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">(s : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#opt_param">opt_param</a> <a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.internal.cache_scope">tactic.local_cache.internal.cache_scope</a> <a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.cache_scope.block_local">tactic.local_cache.cache_scope.block_local</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#unit">unit</a></div>
<div class="indent"><p>Clear cache associated to namespace <code>ns</code>.</p>
       </div>
</div><div class="def"><a id="tactic.local_cache.get"></a>      <span class="decl_name">tactic.local_cache.get</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">(α : Type)</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> α]</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/has_reflect.html#has_reflect">has_reflect</a> α]</span> <span class="decl_args">(s : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#opt_param">opt_param</a> <a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.internal.cache_scope">tactic.local_cache.internal.cache_scope</a> <a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.cache_scope.block_local">tactic.local_cache.cache_scope.block_local</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> (<a href="https://robertylewis.com/mathlib_docs/core/init/core.html#option">option</a> α)</div>
<div class="indent"><p>Gets the (optionally present) value-in-cache for <code>ns</code>.</p>
       </div>
</div><div class="def"><a id="tactic.run_once"></a>      <span class="decl_name">tactic.run_once</span> <span class="decl_args">{α : Type}</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/expr.html#reflected">reflected</a> α]</span> <span class="decl_args">[<a href="https://robertylewis.com/mathlib_docs/core/init/meta/has_reflect.html#has_reflect">has_reflect</a> α]</span> <span class="decl_args">(ns : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/name.html#name">name</a>)</span> <span class="decl_args">(t : <a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> α)</span> <span class="decl_args">(s : <a href="https://robertylewis.com/mathlib_docs/core/init/core.html#opt_param">opt_param</a> <a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.internal.cache_scope">tactic.local_cache.internal.cache_scope</a> <a href="https://robertylewis.com/mathlib_docs/tactic/local_cache.html#tactic.local_cache.cache_scope.block_local">tactic.local_cache.cache_scope.block_local</a>)</span> <span class="decl_args">:</span>       <div class="decl_type"><a href="https://robertylewis.com/mathlib_docs/core/init/meta/tactic.html#tactic">tactic</a> α</div>
<div class="indent"><p>Using the namespace <code>ns</code> as its key, when called for the first
   time <code>run_once ns t</code> runs <code>t</code>, then saves and returns the result.
   Upon subsequent invocations in the same tactic block, with the scope
   of the caching being inherited by child tactic blocks) we return the
   cached result directly.</p>

<p>You can configure the cached scope to be entire <code>def</code>/<code>lemma</code>s changing
   the optional cache_scope argument to <code>cache_scope.def_local</code>.
   Note: the caches backing each scope are different.</p>

<p>If <code>α</code> is just <code>unit</code>, this means we just run <code>t</code> once each tactic
   block.</p>
       </div>
</div></body></html>